import{r,j as a,F as E,a as e,f as I}from"./app-6fa01f51.js";import{u as j}from"./index-8a20468a.js";import{I as L}from"./input-d284db37.js";import{L as g}from"./label-081f6f63.js";import{D as x,a as y,b as k,c as v,d as b}from"./dialog-509cddda.js";import{B as c}from"./button-e2307a57.js";import{c as P}from"./utils-4ffb26b8.js";import{u as q}from"./useSwal-d44257ea.js";import{g as F}from"./index-f537e81f.js";import{x as Q,k as T,i as M}from"./index-e3a1bf56.js";import"./index-af888c1e.js";import"./extends-98964cd2.js";import"./index-3874097f.js";import"./index-f96983da.js";import"./createLucideIcon-c5ae5a41.js";import"./index-46991544.js";function ae({paket:t}){const{ask:O,toast:d}=q(),[o,w]=r.useState(1),[N,C]=r.useState(t.price),[S,n]=r.useState(!1),[m,u]=r.useState(!1),[p,l]=r.useState(null);j("(min-width: 768px)"),r.useEffect(()=>{C(o*t.price)},[o,t.price]);const D=async i=>{if(i.preventDefault(),o<1){d.error("Quantity must be at least 1");return}u(!0);try{const s=new FormData(i.target),f=await I.post(route("packages.book",{slug:t.slug}),s);if(f.data.success)d.success("Booking successful!"),n(!1);else throw new Error(f.data.message||"Booking failed")}catch(s){s.response&&s.response.status===400?l("Existing booking: You already have a pending or approved booking for this package."):l(s.message||"An error occurred while booking")}finally{u(!1)}},B=i=>{w(Math.max(1,parseInt(i.target.value,10)))},h=()=>{l(null)};return a(E,{children:[a(x,{open:S,onOpenChange:n,children:[e(y,{asChild:!0,children:a(c,{variant:"default",onClick:()=>n(!0),className:"w-full",children:[e(Q,{})," Booking Now"]})}),a(k,{className:"sm:max-w-[425px]",children:[a(v,{children:[e(b,{children:"Booking"}),e(F,{children:"Pastikan Sebelum Pembayaran Melakukan Konfirmasi pada Administrator"})]}),a("form",{onSubmit:D,className:"space-y-6 px-4",children:[a("div",{children:[e(g,{htmlFor:"qty",children:"Jumlah Peserta"}),e(L,{type:"number",name:"qty",id:"qty",value:o,onChange:B,min:"1",className:"mt-1 block w-full"})]}),a("div",{children:[e(g,{children:"Grand Total"}),e("div",{className:"mt-1 text-lg font-bold",children:P(N)})]}),e("div",{className:"flex justify-end",children:a(c,{variant:"default",type:"submit",className:"flex w-full items-center",disabled:m,children:[m?"Loading...":e(T,{className:"mr-2 w-3"})," Booking"]})})]})]})]}),p&&a(x,{open:!0,onOpenChange:h,children:[e(y,{asChild:!0,children:e("div",{className:"hidden"})}),a(k,{children:[e(v,{children:e(b,{children:"Error"})}),a("div",{className:"px-4 py-2",children:[e("p",{className:"text-red-600",children:p}),e("div",{className:"flex justify-end mt-4",children:a(c,{variant:"default",onClick:h,children:[e(M,{className:"mr-2 w-3"})," Close"]})})]})]})]})]})}export{ae as default};
